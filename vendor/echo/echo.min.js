/*! echo-js v1.7.3 | (c) 2016 @toddmotto | https://github.com/toddmotto/echo */
(function(a,b){if(typeof define==="function"&&define.amd){define(function(){return b(a)})}else{if(typeof exports==="object"){module.exports=b}else{a.echo=b(a)}}})(this,function(i){var c={};var k=function(){};var e,g,f,j,d;var a=function(l){return(l.offsetParent===null)};var h=function(m,l){if(a(m)){return false}var n=m.getBoundingClientRect();return(n.right>=l.l&&n.bottom>=l.t&&n.left<=l.r&&n.top<=l.b)};var b=function(){if(!j&&!!g){return}clearTimeout(g);g=setTimeout(function(){c.render();g=null},f)};c.init=function(p){p=p||{};var n=p.offset||0;var m=p.offsetVertical||n;var o=p.offsetHorizontal||n;var l=function(q,r){return parseInt(q||r,10)};e={t:l(p.offsetTop,m),b:l(p.offsetBottom,m),l:l(p.offsetLeft,o),r:l(p.offsetRight,o)};f=l(p.throttle,250);j=p.debounce!==false;d=!!p.unload;k=p.callback||k;c.render();if(document.addEventListener){i.addEventListener("scroll",b,false);i.addEventListener("load",b,false)}else{i.attachEvent("onscroll",b);i.attachEvent("onload",b)}};c.render=function(o){var m=(o||document).querySelectorAll("[data-echo], [data-echo-background]");var q=m.length;var r,p;var l={l:0-e.l,t:0-e.t,b:(i.innerHeight||document.documentElement.clientHeight)+e.b,r:(i.innerWidth||document.documentElement.clientWidth)+e.r};for(var n=0;n<q;n++){p=m[n];if(h(p,l)){if(d){p.setAttribute("data-echo-placeholder",p.src)}if(p.getAttribute("data-echo-background")!==null){p.style.backgroundImage="url("+p.getAttribute("data-echo-background")+")"}else{if(p.src!==(r=p.getAttribute("data-echo"))){p.src=r}}if(!d){p.removeAttribute("data-echo");p.removeAttribute("data-echo-background")}k(p,"load")}else{if(d&&!!(r=p.getAttribute("data-echo-placeholder"))){if(p.getAttribute("data-echo-background")!==null){p.style.backgroundImage="url("+r+")"}else{p.src=r}p.removeAttribute("data-echo-placeholder");k(p,"unload")}}}if(!q){c.detach()}};c.detach=function(){if(document.removeEventListener){i.removeEventListener("scroll",b)}else{i.detachEvent("onscroll",b)}clearTimeout(g)};return c});